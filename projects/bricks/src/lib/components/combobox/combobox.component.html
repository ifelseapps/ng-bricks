<div class="wrapper" cdk-scrollable>
  <div
    class="b-combobox-label"
    [class.disabled]="isDisabled$ | async"
    (click)="openPopup()"
    (focus)="onFocus()"
    (keydown.enter)="openPopup()"
    (keydown.arrowDown)="openPopup()"
    tabindex="0"
    #label
  >
    {{((selectedItem$ | async)?.name) || 'Placeholder'}}
  </div>
</div>

<ng-template #popup>
  <div class="b-combobox-popup" cdkTrapFocus>
    <input
      class="b-combobox-search"
      type="text"
      [formControl]="searchField"
      (keydown.arrowDown)="itemsList.next()"
      (keydown.arrowUp)="itemsList.prev()"
      (keydown.enter)="onSelect()"
      (keydown.escape)="closePopup()"
    >
    <b-items-list
      [items]="filteredItems$ | async"
      [selected]="selectedItem$ | async"
      [itemTemplate]="itemTemplate?.templateRef"
      (changeActiveItem)="onChangeActiveItem($event)"
      (selectItem)="onSelect($event)"
      #itemsList
    ></b-items-list>
  </div>
</ng-template>
